## question 7

#### with 1000 observations: 

[[0.54, 0.26, 0.2], [0.19, 0.53, 0.28], [0.22, 0.18, 0.6]]

[[0.5, 0.2, 0.11, 0.19], [0.22, 0.28, 0.23, 0.27], [0.19, 0.21, 0.15, 0.54]]

[0.3, 0.2, 0.5]
**iter 2083**
Convergence
[[0.6964767011564664, 0.013355493674583295, 0.29016780516895063], [0.10146488867814683, 0.8120130540472764, 0.0865220572745761], [0.19211555554192847, 0.3012796960234883, 0.5066047484345829]]

[[0.6887970375846445, 0.2251562809316793, 0.07537025643357922, 0.010676425050097376], [0.06786812278038601, 0.41206670908319215, 0.28139190385771823, 0.23867326427870217], [4.828340972520831e-48, 9.647453456299683e-13, 0.35330163433142786, 0.6466983656676069]]

[0.9999999999999993, 0.0, 0.0]

Our probabilities are close to the generating parameters by 0.01 which is not that bad. 

#### with 10000 observations: 

[[0.54, 0.26, 0.2], [0.19, 0.53, 0.28], [0.22, 0.18, 0.6]]

[[0.5, 0.2, 0.11, 0.19], [0.22, 0.28, 0.23, 0.27], [0.19, 0.21, 0.15, 0.54]]

[0.3, 0.2, 0.5]

**DOESN'T CONVERGE**

Convergence
[[0.6943163621398626, 0.04491806696552644, 0.2607655708946062], [0.11768026408130522, 0.7460895694989249, 0.13623016641977354], [0.15415989310104328, 0.2567256914108647, 0.5891144154880952]]

[[0.7099668348879088, 0.18640320152192533, 0.10359190673347425, 3.8056856688969475e-05], [0.09881460982108434, 0.42111634322825636, 0.31216651053172134, 0.16790253641894065], [0.03210783895921621, 0.17131231904464383, 0.18662603636112132, 0.6099538056350233]]

[0.0, 0.9999999999998928, 5e-323]

It didn't converge. We tried with 5000 iterations that weren't enough for convergence. 

The number of observations needed for convergence depends on the emissions and states. For a large number of emissions it would be relevant to have too many observation otherwise it's waste of computational resources. 

## question 8

#### test1

[array([0.42700817, 0.1339873 , 0.43900454]), array([0.49116739, 0.16895887, 0.33987374]), array([0.31278739, 0.10297883, 0.58423378])]    

[array([0.16028248, 0.59526825, 0.19288419, 0.05156507]), array([0.60832265, 0.10710967, 0.0715572 , 0.21301048]), array([0.32037354, 0.27760474, 0.00277625, 0.39924546])]

[0.53775766 0.34005283 0.12218951]

- **Iter: 1909**

Convergence
[array([0.81201301, 0.10146486, 0.08652213]), array([0.01335551, 0.69647653, 0.29016796]), array([0.30127958, 0.19211571, 0.50660472])]    

[array([0.0678681 , 0.41206674, 0.28139192, 0.23867324]), array([0.68879718, 0.22515636, 0.0753702 , 0.01067626]), array([1.38299916e-41, 7.74520466e-13, 3.53301609e-01, 6.46698391e-01])]

[0. 1. 0.]

#### test2

[array([0.35440211, 0.54700477, 0.09859312]), array([0.08355701, 0.18197113, 0.73447185]), array([0.04527708, 0.65054683, 0.30417609])]

[array([0.31402874, 0.08125026, 0.0823503 , 0.5223707 ]), array([0.22444248, 0.35802599, 0.20233694, 0.21519459]), array([0.12071824, 0.4978858 , 0.25704478, 0.12435119])]

[0.28884353 0.30103453 0.41012194]

- **iter 2280**

Convergence
[array([0.6964764 , 0.29016808, 0.01335552]), array([0.19211582, 0.50660469, 0.30127949]), array([0.10146484, 0.08652218, 0.81201298])]    

[array([0.68879729, 0.22515642, 0.07537016, 0.01067613]), array([2.42047562e-47, 4.07749541e-13, 3.53301590e-01, 6.46698410e-01]), array([0.06786808, 0.41206676, 0.28139194, 0.23867323])]

[1. 0. 0.]

#### test3

[array([0.27457232, 0.09241927, 0.63300841]), array([0.53228177, 0.18990041, 0.27781782]), array([0.4096195 , 0.57421691, 0.0161636 ])]    

[array([0.21753003, 0.06160486, 0.35766594, 0.36319917]), array([0.04316925, 0.07780252, 0.41978   , 0.45924824]), array([0.28723548, 0.01368196, 0.67223513, 0.02684743])]

[0.25668773 0.5891708  0.15414147]

**DOESN'T CONVERGE**

Convergence
[array([6.42212919e-01, 4.82948503e-16, 3.57787081e-01]), array([0.10869648, 0.83936755, 0.05193597]), array([1.19370118e-07, 9.99999881e-01, 6.31358052e-39])]

[array([0.67498542, 0.1986271 , 0.07891377, 0.0474737 ]), array([1.63981779e-07, 3.03102559e-01, 3.21826495e-01, 3.75070782e-01]), array([9.35114638e-01, 1.03945485e-95, 2.33177578e-06, 6.48830298e-02])]

[0. 0. 1.]

#### problem with evaluating distances between matrices: 

These distance measures all have somewhat different properties. For example, the third one shown above will tell you that two matrices are far apart even if all their entries are the same except for a large difference in one position.

## question 9

##### N=5

[array([0.03300007, 0.21613722, 0.12056949, 0.40647003, 0.22382318]), array([0.40739083, 0.02156884, 0.09130673, 0.16237621, 0.3173574 ]), 
array([0.0175758 , 0.43103174, 0.32693238, 0.09980547, 0.12465461]), array([0.24414015, 0.31886529, 0.19494244, 0.01230015, 0.22975197]), array([0.20445274, 0.13844147, 0.41953185, 0.0702679 , 0.16730605])]

[array([0.14329267, 0.5962856 , 0.21045328, 0.04996844]), array([0.10344506, 0.67678532, 0.13865061, 0.081119  ]), array([0.23807459, 0.34411932, 0.22726026, 0.19054583]), array([0.1077129 , 0.10194609, 0.58359224, 0.20674877]), array([0.32572139, 0.00117103, 0.31046309, 0.36264449])]

[0.32530394 0.08379144 0.01408817 0.48711803 0.08969842]
**iter 3930**
Convergence
[array([3.08816677e-01, 1.91328982e-36, 2.33240682e-01, 2.72450042e-01,
       1.85492599e-01]), array([8.39268864e-001, 2.37634430e-135, 1.33821020e-001, 7.90785734e-080,
       2.69101164e-002]), array([3.96097755e-17, 6.59646494e-91, 4.81774553e-01, 2.58992735e-01,
       2.59232712e-01]), array([3.11843780e-01, 5.16600842e-01, 1.89526896e-54, 1.71555378e-01,
       4.49408051e-38]), array([3.44220288e-096, 1.00084282e-001, 2.65725458e-001, 2.05743246e-162,
       6.34190261e-001])]

[array([1.06526863e-01, 6.99195158e-01, 1.94277978e-01, 1.10612758e-70]), array([1.91277618e-310, 6.22834235e-001, 5.95455276e-002, 3.17620237e-001]), array([6.99690342e-71, 1.60487396e-09, 3.33479797e-01, 6.66520202e-01]), array([7.33912801e-55, 3.07659459e-41, 5.59481551e-01, 4.40518449e-01]), array([7.56096056e-01, 1.65231437e-01, 7.86725074e-02, 2.35072003e-69])]

[0. 0. 0. 0. 1.]

##### N=2

[array([0.92236439, 0.07763561]), array([0.77275181, 0.22724819])]

[array([0.07905581, 0.21231616, 0.28263664, 0.42599138]), array([0.28223922, 0.07575635, 0.57170545, 0.07029898])]

[0.16252473 0.83747527]
**iter 3489**
Convergence
[array([0.80981176, 0.19018824]), array([0.3567636, 0.6432364])]

[array([4.88040802e-10, 2.92307840e-01, 3.20251163e-01, 3.87440997e-01]), array([0.69597956, 0.16540516, 0.07894628, 0.059669  ])]

[0. 1.]

##### N=7

[array([0.09020432, 0.25489876, 0.10046603, 0.03595703, 0.31692685,
       0.18838991, 0.0131571 ]), array([0.11720077, 0.36316868, 0.0187272 , 0.14017073, 0.18735264,
       0.06936427, 0.10401571]), array([0.00284131, 0.10459241, 0.12545203, 0.4614132 , 0.11421013,
       0.15682694, 0.03466399]), array([0.19447545, 0.23149734, 0.1842278 , 0.19059086, 0.00047859,
       0.18160669, 0.01712327]), array([0.07004154, 0.08489624, 0.0904061 , 0.13252239, 0.26793992,
       0.33606062, 0.01813318]), array([0.01718468, 0.19535264, 0.47739967, 0.07203589, 0.03544062,
       0.00480878, 0.19777772]), array([0.47355751, 0.05218612, 0.15840959, 0.00402404, 0.10716134,
       0.05296233, 0.15169908])]

[array([0.22661138, 0.6205254 , 0.10766553, 0.04519769]), array([0.538511  , 0.17784027, 0.2756709 , 0.00797783]), array([0.20155314, 0.00426377, 0.19880304, 0.59538005]), array([0.17122885, 0.1682768 , 0.27128618, 0.38920817]), array([0.18235144, 0.02756839, 0.73173779, 0.05834237]), array([0.23130236, 0.18779109, 0.45559968, 0.12530687]), array([0.18731503, 0.14572264, 0.40963421, 0.25732813])]

[0.36715562 0.11432087 0.02649232 0.01072866 0.05266615 0.27382685
 0.15480954]
**iter 3006**
Convergence
[array([3.94232096e-01, 4.63311088e-02, 1.26266374e-01, 3.33541223e-74,
       9.31930930e-18, 4.33170421e-01, 2.09685322e-28]), array([3.97544643e-153, 6.66211208e-001, 2.14747338e-003, 8.83882251e-021,        
       3.31641318e-001, 1.49983731e-133, 1.51081417e-146]), array([2.73427465e-084, 1.12806545e-138, 2.65811091e-001, 4.64789531e-145,     
       7.34188909e-001, 3.91242111e-042, 7.76930672e-037]), array([5.61955931e-017, 8.96539568e-166, 1.51083841e-001, 6.67689832e-001,     
       4.63709766e-152, 4.26059094e-023, 1.81226327e-001]), array([3.63370139e-136, 2.95719853e-001, 3.12609076e-175, 6.98404105e-002,     
       2.66959345e-001, 3.67480392e-001, 5.47743940e-032]), array([1.72582667e-01, 1.72840002e-01, 3.51175101e-65, 6.58186431e-03,
       7.15415929e-15, 3.16972506e-10, 6.47995466e-01]), array([5.71193793e-001, 4.12587650e-002, 6.49198922e-259, 4.24292655e-049,        
       4.44810202e-074, 8.59546685e-018, 3.87547442e-001])]

[array([2.43654048e-01, 7.56345952e-01, 3.04104590e-34, 8.03533630e-96]), array([7.38976013e-01, 2.44591299e-01, 1.64326874e-02, 7.08181919e-11]), array([4.59964851e-70, 2.67816588e-53, 1.64145677e-58, 1.00000000e+00]), array([0.00000000e+000, 1.51214016e-182, 4.48062926e-001, 
5.51937074e-001]), array([2.09350116e-67, 1.80521496e-74, 4.42987146e-01, 5.57012854e-01]), array([5.48433289e-176, 8.99394119e-002, 6.26855911e-001, 2.83204677e-001]), array([7.32308518e-106, 1.54207824e-001, 3.39645752e-001, 5.06146424e-001])]

[8.4e-323 1.0e+000 0.0e+000 0.0e+000 0.0e+000 0.0e+000 0.0e+000]

##### N=10

[array([0.08850123, 0.23566107, 0.06568929, 0.0880464 , 0.04278987,
       0.11644436, 0.13347958, 0.03374494, 0.01504945, 0.18059381]), array([0.11340282, 0.04552231, 0.06851439, 0.2374
       0.07312777, 0.30220873, 0.00946902, 0.09551044, 0.0226342 ]), array([0.06555238, 0.13527931, 0.05681005, 0.0209
       0.11430096, 0.28278187, 0.06480327, 0.07682909, 0.03418244]), array([0.09622674, 0.18291508, 0.03751228, 0.0105
       0.04847987, 0.05943017, 0.04490373, 0.02640364, 0.15472338]), array([0.08637195, 0.01363043, 0.35727556, 0.05534232, 0.18481193,
       0.03855439, 0.06423814, 0.03112613, 0.03782072, 0.13082844]), array([0.00641772, 0.03491631, 0.11350464, 0.02133731, 0.01474414,
       0.00076557, 0.54437321, 0.20092584, 0.0569744 , 0.00604086]), array([0.03530399, 0.06408852, 0.07198653, 0.13243981, 0.01218404,
       0.00122267, 0.01706065, 0.24590177, 0.31268187, 0.10713015])]

[array([0.42590108, 0.02468719, 0.28455109, 0.26486064]), array([0.48296116, 0.10805402, 0.16877521, 0.24020961]), array([0.10871279, 0.34542147, 0.19492088, 0.35094486]), array([0.30810506, 0.17414158, 0.16162302, 0.35613035]), array([0.05821463, 0.29883086, 0.07942404, 0.56353048]), array([0.59791752, 0.18684751, 0.04863612, 0.16659885]), array([0.47376606, 0.11568304, 0.37215361, 0.0383973 ]), array([0.31570659, 0.16832229, 0.1202436 , 0.39572753]), array([0.22374653, 0.54159119, 0.14526177, 0.08940052]), array([0.10427451, 0.07971668, 0.39684758, 0.41916122])]

[0.19042638 0.1116483  0.01725331 0.04799636 0.03387154 0.00292368
 0.11120662 0.1651877  0.16970777 0.14977834]
Convergence
[array([2.93251879e-001, 7.10826210e-002, 1.20522129e-178, 1.38055619e-001,
       3.25665265e-001, 0.00000000e+000, 0.00000000e+000, 4.35121891e-010,
       2.92509588e-004, 1.71652106e-001]), array([1.23134135e-001, 8.70385073e-318, 3.79704356e-102, 7.55546484e-001,
       1.21319380e-001, 9.39856301e-111, 1.16022234e-039, 0.00000000e+000,
       9.78310530e-099, 2.33430450e-259]), array([2.02600716e-011, 1.48219694e-323, 2.35866613e-001, 6.99895059e-002,
       4.62464535e-001, 4.56110033e-281, 5.35360441e-105, 5.00324162e-248,
       5.11349464e-099, 2.31679346e-001]), array([3.98188302e-001, 2.53069832e-001, 0.00000000e+000, 6.68563381e-203,
       6.16048740e-174, 3.30290917e-002, 9.28271355e-227, 1.82339082e-152,
       3.15712774e-001, 0.00000000e+000]), array([3.89485273e-001, 1.43363514e-001, 0.00000000e+000, 1.02515280e-066,
       6.48865734e-018, 3.45845952e-323, 3.06416117e-002, 3.12396206e-001,
       7.28442196e-002, 5.12691758e-002]), array([6.48847331e-111, 0.00000000e+000, 0.00000000e+000, 5.51910116e-199,
       9.20992935e-057, 7.17475884e-201, 0.00000000e+000, 0.00000000e+000,
       1.00000000e+000, 1.69771687e-260]), array([7.11608158e-243, 5.11684271e-001, 1.76964960e-001, 5.03080558e-153,
       0.00000000e+000, 7.97791177e-002, 4.94065646e-324, 0.00000000e+000,
       0.00000000e+000, 2.31571651e-001]), array([6.21500893e-002, 5.11669923e-229, 8.01303987e-001, 4.48570865e-142,
       1.68223385e-079, 6.37320502e-002, 6.28903558e-273, 1.38670251e-093,
       7.28138738e-002, 1.42812540e-027]), array([0.00000000e+000, 1.24081806e-150, 9.71542103e-093, 0.00000000e+000,
       0.00000000e+000, 0.00000000e+000, 1.00000000e+000, 0.00000000e+000,
       0.00000000e+000, 0.00000000e+000]), array([9.78686348e-002, 1.39232658e-153, 1.48219694e-323, 3.97272689e-278,
       1.94818554e-001, 8.73238544e-101, 0.00000000e+000, 5.01195746e-001,
       2.06117065e-001, 8.40189532e-195])]

[array([1.89467321e-186, 0.00000000e+000, 4.05821665e-001, 5.94178335e-001]), array([9.37079064e-001, 0.00000000e+000, 7.31486082e-301, 6.29209362e-002]), array([3.94250889e-256, 1.00000000e+000, 3.10694993e-163, 1.50280644e-233]), array([8.53630933e-01, 3.38817229e-20, 7.19064110e-02, 7.44626559e-02]), array([0.00000000e+00, 2.12490793e-01, 1.69937004e-62, 7.87509207e-01]), array([0.00000000e+000, 4.85661882e-001, 1.19515726e-285, 5.14338118e-001]), array([0.5197009 , 0.16890907, 0.29738504, 0.01400499]), 
array([0.        , 0.17903166, 0.39591067, 0.42505768]), array([3.63881119e-22, 8.44438973e-01, 1.55561027e-01, 0.00000000e+00]), array([0.00000000e+000, 2.66013269e-202, 1.00000000e+000, 2.23939621e-085])]

[0.00000000e+000 4.89638356e-221 0.00000000e+000 1.00000000e+000
 0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
 0.00000000e+000 0.00000000e+000]

[0.00000000e+000 4.89638356e-221 0.00000000e+000 1.00000000e+000
 0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
 0.00000000e+000 0.00000000e+000]

## Question 10

### uniform distribution 

[[0.3333333333333333, 0.3333333333333333, 0.3333333333333333], [0.3333333333333333, 0.3333333333333333, 0.3333333333333333], [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]]

[[0.25, 0.25, 0.25, 0.25], [0.25, 0.25, 0.25, 0.25], [0.25, 0.25, 0.25, 0.25]]

[0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
**iter 1**
Convergence
[[0.33333333333334125, 0.33333333333334125, 0.33333333333334125], [0.33333333333334125, 0.33333333333334125, 0.33333333333334125], [0.33333333333334125, 0.33333333333334125, 0.33333333333334125]]

[[0.24300000000000088, 0.24800000000000083, 0.23600000000000096, 0.2730000000000006], [0.24300000000000088, 0.24800000000000083, 0.23600000000000096, 0.2730000000000006], [0.24300000000000088, 0.24800000000000083, 0.23600000000000096, 0.2730000000000006]]

[0.3333333333333331, 0.3333333333333331, 0.3333333333333331]

It was expected as the uniform distribution is the already optimal result. Initializing the parameters with a uniform distribution we'll only lead to a uniform distribution very fast (at the first iteration).

### diagonal matrix A 

[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]

[array([0.32554219, 0.0141255 , 0.01721131, 0.64312099]), array([0.0251642 , 0.02182675, 0.68825882, 0.26475023]), array([0.1882704 , 0.25998551, 0.30965785, 0.24208624])]

[0, 0, 1]
hmm_3_C.py:98: RuntimeWarning: invalid value encountered in double_scalars = division by zero (maybe)
  A[i][j] = numer / denom
hmm_3_C.py:110: RuntimeWarning: invalid value encountered in double_scalars
  B[i][j] = numer / denom
Convergence
[[nan nan nan]
 [nan nan nan]
 [nan nan nan]]

[array([nan, nan, nan, nan]), array([nan, nan, nan, nan]), array([nan, nan, nan, nan])]

[nan, nan, nan]

### close to the solution

[[0.6964767011564664, 0.013355493674583295, 0.29016780516895063], [0.10146488867814683, 0.8120130540472764, 0.0865220572745761], [0.19211555554192847, 0.3012796960234883, 0.5066047484345829]]

[[0.6887970375846445, 0.2251562809316793, 0.07537025643357922, 0.010676425050097376], [0.06786812278038601, 0.41206670908319215, 0.28139190385771823, 0.23867326427870217], [4.828340972520831e-48, 9.647453456299683e-13, 0.35330163433142786, 0.6466983656676069]]

[0.9999999999999993, 0.0, 0.0]
**iter 23**
Convergence
[[0.696476465120526, 0.013355514472766705, 0.2901680204067052], [0.10146485099008919, 0.8120129928278612, 0.08652215618204981], [0.19211576004132905, 0.3012795359290566, 0.506604704029614]]

[[0.6887972342960818, 0.22515639177588906, 0.07537017904833632, 0.01067619487969134], [0.06786808741357217, 0.4120667464058652, 0.2813919276606298, 0.23867323851993302], [1.5131512904711085e-48, 7.186015779101739e-13, 0.35330160014922773, 0.6466983998500534]]

[1.000000000000013, 0.0, 0.0]

